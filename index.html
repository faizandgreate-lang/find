<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Smart Location Finder — Fancy Themes & Effects</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap');

  :root{
    --accent: #000;
    --bg: #fff;
    --card-bg: rgba(255,255,255,0.8);
    --btn-bg: rgba(255,255,255,0.9);
    --btn-border: rgba(0,0,0,0.15);
  }

  /* Base layout */
  html,body{height:100%;margin:0;font-family:"Merriweather",serif;-webkit-font-smoothing:antialiased;}
  body{
    display:flex;flex-direction:column;align-items:center;min-height:100vh;
    color:var(--accent);background:var(--bg);transition:background 600ms ease,color 400ms;
    overflow-x:hidden;position:relative;
  }

  /* Header with logo and tiny dots */
  header{
    width:92%;max-width:820px;margin:12px auto 6px;display:flex;align-items:center;justify-content:center;
    position:relative;gap:22px;
  }

  .logo-wrap{
    display:flex;align-items:center;gap:14px;position:relative;
  }

  .tiny-dot{
    width:14px;height:14px;border-radius:50%;box-shadow:0 4px 18px rgba(0,0,0,0.15);
    cursor:pointer;display:flex;align-items:center;justify-content:center;position:relative;
    transition:transform 160ms ease, box-shadow 160ms ease, opacity 220ms;
    z-index:60;
  }
  .tiny-dot:active{ transform:scale(.9); }
  .tiny-dot.left{ margin-right: -12px; } /* keep close to logo */
  .tiny-dot.right{ margin-left: -12px; }

  .logo{
    width:150px;height:auto;border-radius:10px;box-shadow:0 8px 26px rgba(0,0,0,0.12);
    animation:logo-breathe 3s ease-in-out infinite; z-index:50;
  }
  @keyframes logo-breathe{
    0%,100%{ transform:scale(1);opacity:.96 }
    50%{ transform:scale(1.04);opacity:1 }
  }

  /* Floating theme button (no label) */
  .theme-btn{
    position:fixed;right:18px;bottom:18px;z-index:999;padding:10px;border-radius:12px;
    border:2px solid var(--btn-border);background:var(--btn-bg);box-shadow:0 8px 22px rgba(0,0,0,0.12);
    width:46px;height:46px;display:flex;align-items:center;justify-content:center;cursor:pointer;
    transition:transform .18s ease, background .3s, border-color .3s;
  }
  .theme-btn:active{ transform:scale(.96) }

  /* icon dot inside theme button */
  .theme-dot{ width:16px;height:16px;border-radius:50%;background:var(--accent);box-shadow:0 6px 18px rgba(0,0,0,0.12); }

  /* controls + cards */
  .controls{ width:92%;max-width:820px;margin:6px auto 12px;display:flex;flex-direction:column;align-items:center;gap:10px;z-index:30; }
  .btn{
    min-width:200px;max-width:90%;padding:12px 18px;border-radius:10px;border:2px solid var(--btn-border);background:var(--card-bg);
    font-weight:700;color:var(--accent);cursor:pointer;box-shadow:0 6px 20px rgba(0,0,0,0.06);transition:transform .15s ease,background .2s;
  }
  .btn:active{ transform:translateY(1px) }
  .btn.small{ min-width:120px;padding:8px 12px;font-size:14px }

  /* map and output */
  #map{ width:92%;max-width:820px;height:320px;border-radius:12px;overflow:hidden;margin-top:10px;box-shadow:0 10px 30px rgba(0,0,0,0.10);z-index:10 }
  #output{ width:92%;max-width:820px;padding:14px;border-radius:12px;margin:12px auto 30px;background:var(--card-bg);box-shadow:0 8px 22px rgba(0,0,0,0.06); color:var(--accent); z-index:10; }

  table{ width:100%;border-collapse:collapse }
  th,td{ padding:10px;border-bottom:1px solid rgba(0,0,0,0.08);text-align:left }
  th{ background:rgba(255,255,255,0.6);font-weight:700 }

  footer{ width:100%;text-align:center;padding:12px 8px 36px;color:var(--accent);font-size:14px }

  /* Particle canvases overlay (full-screen, pointer-events none unless activated) */
  canvas.particles, canvas.ripple{
    position:fixed;left:0;top:0;width:100%;height:100%;z-index:80;pointer-events:none;
  }

  /* Theme presets — 10 themes (bg gradients, accent & card styles) */
  /* Each theme sets: background, --accent color, --card-bg, --btn-bg, --btn-border */
  body.t1{ background: radial-gradient(circle at 15% 20%, #FFDEE9 0%, #B5FFFC 60%); --accent:#1b1b1b; --card-bg: rgba(255,255,255,0.86); --btn-bg: rgba(255,255,255,0.95); --btn-border: rgba(0,0,0,0.12); }
  body.t2{ background: linear-gradient(135deg,#F6D365,#FDA085); --accent:#1b1108; --card-bg: rgba(255,250,242,0.8); --btn-bg: rgba(255,250,242,0.95); --btn-border: rgba(0,0,0,0.12); }
  body.t3{ background: linear-gradient(45deg,#89FFFD,#EF32D9); --accent:#111; --card-bg: rgba(255,255,255,0.82); --btn-bg: rgba(255,255,255,0.95); --btn-border: rgba(0,0,0,0.12); }
  body.t4{ background: linear-gradient(90deg,#A18CD1,#FBC2EB); --accent:#22122b; --card-bg: rgba(255,255,255,0.84); --btn-bg: rgba(255,255,255,0.95); --btn-border: rgba(0,0,0,0.12); }
  body.t5{ background: linear-gradient(135deg,#FFAFBD,#ffc3a0); --accent:#2a0d07; --card-bg: rgba(255,255,255,0.82); --btn-bg: rgba(255,255,255,0.95); --btn-border: rgba(0,0,0,0.12); }
  body.t6{ background: radial-gradient(circle,#f5f7fa,#c3cfe2); --accent:#0b2a3b; --card-bg: rgba(255,255,255,0.78); --btn-bg: rgba(255,255,255,0.95); --btn-border: rgba(0,0,0,0.08); }
  body.t7{ background: linear-gradient(120deg,#89f7fe,#66a6ff); --accent:#021b3a; --card-bg: rgba(255,255,255,0.82); --btn-bg: rgba(255,255,255,0.95); --btn-border: rgba(0,0,0,0.08); }
  body.t8{ background: linear-gradient(45deg,#f093fb,#f5576c); --accent:#2b0810; --card-bg: rgba(255,255,255,0.82); --btn-bg: rgba(255,255,255,0.92); --btn-border: rgba(0,0,0,0.1); }
  body.t9{ background: linear-gradient(60deg,#5ee7df,#b490ca); --accent:#121018; --card-bg: rgba(255,255,255,0.82); --btn-bg: rgba(255,255,255,0.92); --btn-border: rgba(0,0,0,0.1); }
  body.t10{ background: radial-gradient(circle at center,#fad0c4,#ffd1ff); --accent:#21111e; --card-bg: rgba(255,255,255,0.86); --btn-bg: rgba(255,255,255,0.95); --btn-border: rgba(0,0,0,0.12); }

  /* theme-specific fine tunings: tiny-dot colors and theme-dot */
  body.t1 .tiny-dot{ background:linear-gradient(180deg,#ff7aa2,#ffb3d4); box-shadow:0 6px 18px rgba(255,122,162,0.18) }
  body.t2 .tiny-dot{ background:linear-gradient(180deg,#ffd67a,#ffb38a); box-shadow:0 6px 18px rgba(246,211,101,0.14) }
  body.t3 .tiny-dot{ background:linear-gradient(180deg,#6fffea,#ff66d4); box-shadow:0 6px 18px rgba(137,255,253,0.14) }
  body.t4 .tiny-dot{ background:linear-gradient(180deg,#bfa6e6,#f6c8ee); box-shadow:0 6px 18px rgba(161,140,209,0.14) }
  body.t5 .tiny-dot{ background:linear-gradient(180deg,#ff9fb0,#ffc4a8); box-shadow:0 6px 18px rgba(255,159,176,0.14) }
  body.t6 .tiny-dot{ background:linear-gradient(180deg,#dfe9f3,#bcd1e6); box-shadow:0 6px 18px rgba(200,210,230,0.14) }
  body.t7 .tiny-dot{ background:linear-gradient(180deg,#7efcff,#64a7ff); box-shadow:0 6px 18px rgba(106,200,255,0.14) }
  body.t8 .tiny-dot{ background:linear-gradient(180deg,#f7b0fb,#ff9a8c); box-shadow:0 6px 18px rgba(247,176,251,0.14) }
  body.t9 .tiny-dot{ background:linear-gradient(180deg,#7ff7ea,#c9a3e0); box-shadow:0 6px 18px rgba(125,231,222,0.14) }
  body.t10 .tiny-dot{ background:linear-gradient(180deg,#ffd8c4,#ffd1ff); box-shadow:0 6px 18px rgba(255,210,220,0.14) }

  /* theme button color change */
  body.t1 .theme-dot{ background:#1b1b1b }
  body.t2 .theme-dot{ background:#1b1108 }
  body.t3 .theme-dot{ background:#111 }
  body.t4 .theme-dot{ background:#22122b }
  body.t5 .theme-dot{ background:#2a0d07 }
  body.t6 .theme-dot{ background:#0b2a3b }
  body.t7 .theme-dot{ background:#021b3a }
  body.t8 .theme-dot{ background:#2b0810 }
  body.t9 .theme-dot{ background:#121018 }
  body.t10 .theme-dot{ background:#21111e }

  /* responsive smaller spacing */
  @media(max-width:520px){
    .logo{ width:120px }
    header{ gap:8px }
    .tiny-dot{ width:12px;height:12px }
    .theme-btn{ right:12px;bottom:12px;width:44px;height:44px }
    .btn{ min-width:160px }
    #map{ height:240px }
  }

</style>
</head>
<body class="t1">

<!-- Particle canvases -->
<canvas class="particles" id="particlesCanvas"></canvas>
<canvas class="ripple" id="rippleCanvas"></canvas>

<header>
  <div class="logo-wrap" aria-hidden="false">
    <!-- left tiny dot triggers spark explosion -->
    <div class="tiny-dot left" id="leftDot" title="Spark">
      <!-- decorative inner -->
      <svg width="6" height="6" viewBox="0 0 10 10" style="opacity:.9"><circle cx="5" cy="5" r="4" fill="rgba(255,255,255,0.5)"/></svg>
    </div>

    <img src="https://i.ibb.co/jPQz0mKf/Screenshot-2025-11-05-at-8-24-36-PM.png" class="logo" alt="Logo">

    <!-- right tiny dot triggers ripple -->
    <div class="tiny-dot right" id="rightDot" title="Ripple">
      <svg width="6" height="6" viewBox="0 0 10 10" style="opacity:.9"><circle cx="5" cy="5" r="4" fill="rgba(255,255,255,0.5)"/></svg>
    </div>
  </div>
</header>

<!-- Main functional controls -->
<div class="controls" role="region" aria-label="controls">
  <button class="btn small" onclick="getZip()">Get My ZIP Code</button>
  <button class="btn small" onclick="getAddress()">Get My Address</button>
  <button class="btn small" onclick="listNearby()">List Nearby Places</button>
</div>

<div id="map">
  <iframe id="osm-map" width="100%" height="100%" style="border:0" loading="lazy" allowfullscreen
    src="https://www.openstreetmap.org/export/embed.html?bbox=46.665,24.705,46.685,24.725&layer=mapnik&marker=24.7136,46.6753"></iframe>
</div>

<div id="output">Results will appear here</div>

<footer>
  <a href="https://www.linux-aios.com/" target="_blank" rel="noopener">Visit My Blog</a> |
  <a href="https://www.instagram.com/mohammad_faizan_khan_/" target="_blank" rel="noopener">@mohammad_faizan_khan_</a>
</footer>

<!-- Theme button (single) -->
<div class="theme-btn" id="themeBtn" aria-label="change theme" title="Change Theme">
  <div class="theme-dot"></div>
</div>

<script>
/* ========== THEME CYCLE ========== */
let themeIndex = 1;
const maxThemes = 10;
const body = document.body;
const themeBtn = document.getElementById('themeBtn');

function applyTheme(i){
  // remove all tX classes, then add target
  for(let k=1;k<=maxThemes;k++) body.classList.remove('t'+k);
  body.classList.add('t'+i);

  // also update CSS variables (accent & card brightness) dynamically if needed
  // this is already handled by theme classes in CSS
}
applyTheme(themeIndex);

themeBtn.addEventListener('click', function(){
  themeIndex++; if(themeIndex>maxThemes) themeIndex=1;
  applyTheme(themeIndex);
  // small pulse on click
  themeBtn.animate([{transform:'scale(1)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],{duration:260});
});


/* ========== PARTICLES: Spark Explosion (left dot) ========== */
/* lightweight canvas particles — burst from logo center */
const pCanvas = document.getElementById('particlesCanvas');
const pCtx = pCanvas.getContext('2d');
let pDpr = Math.max(1,window.devicePixelRatio || 1);

function resizeParticlesCanvas(){
  pDpr = Math.max(1,window.devicePixelRatio || 1);
  pCanvas.width = Math.floor(window.innerWidth * pDpr);
  pCanvas.height = Math.floor(window.innerHeight * pDpr);
  pCanvas.style.width = window.innerWidth + 'px';
  pCanvas.style.height = window.innerHeight + 'px';
  pCtx.setTransform(pDpr,0,0,pDpr,0,0);
}
resizeParticlesCanvas();
window.addEventListener('resize', resizeParticlesCanvas);

let particles = [];
function spawnSpark(x,y,theme){
  const count = 36; // modest count for mobile
  const colors = [
    '#fff', '#ffd6e0', '#ffefc3', '#a6fff2', '#ffd7b6', '#ffe0ff'
  ];
  for(let i=0;i<count;i++){
    const a = Math.random()*Math.PI*2;
    const speed = 1 + Math.random()*3;
    particles.push({
      x,y,
      vx: Math.cos(a)*speed*(0.6+Math.random()),
      vy: Math.sin(a)*speed*(0.6+Math.random()),
      life: 40 + Math.random()*30,
      size: 1 + Math.random()*3,
      color: colors[Math.floor(Math.random()*colors.length)],
      ttl: 60 + Math.random()*30
    });
  }
}

/* physics & draw */
function tickParticles(){
  pCtx.clearRect(0,0,window.innerWidth,window.innerHeight);
  for(let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.vy += 0.06; // gravity
    p.x += p.vx;
    p.y += p.vy;
    p.life--;
    p.size *= 0.985;
    pCtx.globalAlpha = Math.max(0, Math.min(1, p.life / p.ttl));
    pCtx.fillStyle = p.color;
    pCtx.beginPath();
    pCtx.arc(p.x, p.y, Math.max(0.2,p.size), 0, Math.PI*2);
    pCtx.fill();
    if(p.life <= 0 || p.size <= 0.2) particles.splice(i,1);
  }
  requestAnimationFrame(tickParticles);
}
tickParticles();

/* left dot click -> compute logo center and spawn spark */
const leftDot = document.getElementById('leftDot');
leftDot.addEventListener('click', function(e){
  // compute visual center near logo
  const logo = document.querySelector('.logo');
  const rect = logo.getBoundingClientRect();
  const cx = rect.left + rect.width/2 + (Math.random()*8-4);
  const cy = rect.top + rect.height/2 + (Math.random()*6-3);
  spawnSpark(cx,cy,themeIndex);

  // small global burst audio-less visual: pulse of theme button
  themeBtn.animate([{transform:'scale(1)'},{transform:'scale(.94)'},{transform:'scale(1)'}],{duration:340});

  // additional faint radial flash (css pseudo) using quick canvas circle
  pCtx.save();
  pCtx.beginPath();
  pCtx.fillStyle = 'rgba(255,255,255,0.08)';
  pCtx.arc(cx,cy,60,0,Math.PI*2);pCtx.fill();
  pCtx.restore();
});

/* ========== RIPPLE: Particle Wave Ripple (right dot) ========== */
const rCanvas = document.getElementById('rippleCanvas');
const rCtx = rCanvas.getContext('2d');
function resizeRippleCanvas(){
  rCanvas.width = Math.floor(window.innerWidth * pDpr);
  rCanvas.height = Math.floor(window.innerHeight * pDpr);
  rCanvas.style.width = window.innerWidth + 'px';
  rCanvas.style.height = window.innerHeight + 'px';
  rCtx.setTransform(pDpr,0,0,pDpr,0,0);
}
resizeRippleCanvas();
window.addEventListener('resize', resizeRippleCanvas);

let ripples = [];
function spawnRipple(x,y){
  // create multiple expanding rings
  for(let i=0;i<3;i++){
    ripples.push({
      x,y,
      r: 8 + i*18,
      width: 28,
      life: 0,
      maxLife: 100 + i*25,
      alpha: 0.8 - i*0.22
    });
  }
}

function tickRipples(){
  rCtx.clearRect(0,0,window.innerWidth,window.innerHeight);
  for(let i=ripples.length-1;i>=0;i--){
    const s = ripples[i];
    s.life += 1;
    s.r += 2.6 * (1 + s.life/120);
    s.width *= 0.995;
    const prog = s.life / s.maxLife;
    if(prog>1){ ripples.splice(i,1); continue; }
    rCtx.beginPath();
    rCtx.lineWidth = Math.max(1, s.width*(1-prog));
    rCtx.strokeStyle = `rgba(255,255,255,${Math.max(0, s.alpha*(1-prog))})`;
    rCtx.arc(s.x, s.y, s.r, 0, Math.PI*2);
    rCtx.stroke();
  }
  requestAnimationFrame(tickRipples);
}
tickRipples();

const rightDot = document.getElementById('rightDot');
rightDot.addEventListener('click', function(e){
  const logo = document.querySelector('.logo');
  const rect = logo.getBoundingClientRect();
  const cx = rect.left + rect.width/2 + (Math.random()*8-4);
  const cy = rect.top + rect.height/2 + (Math.random()*6-3);
  spawnRipple(cx,cy);

  // small themeBtn flash
  themeBtn.animate([{opacity:1},{opacity:.6},{opacity:1}],{duration:300});
});

/* ========== MAP / GEO / OSM FUNCTIONS (unchanged, same as yours) ========== */
function getLocation() {
  return new Promise((resolve, reject) => {
    if(navigator.geolocation){
      navigator.geolocation.getCurrentPosition(pos => resolve({lat: pos.coords.latitude, lon: pos.coords.longitude}),
      err => reject("Location access denied or unavailable"));
    } else reject("Geolocation not supported");
  });
}

async function getZip() {
  try {
    const loc = await getLocation();
    const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${loc.lat}&lon=${loc.lon}&format=json`);
    const data = await res.json();
    document.getElementById('output').innerText = "ZIP Code: " + (data.address && data.address.postcode ? data.address.postcode : "Not found");
    updateMap(loc.lat, loc.lon);
  } catch(err) { document.getElementById('output').innerText = err; }
}

async function getAddress() {
  try {
    const loc = await getLocation();
    const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${loc.lat}&lon=${loc.lon}&format=json`);
    const data = await res.json();
    document.getElementById('output').innerText = "Address: " + (data.display_name || "Not found");
    updateMap(loc.lat, loc.lon);
  } catch(err) { document.getElementById('output').innerText = err; }
}

function getDistance(lat1, lon1, lat2, lon2){
  const R = 6371;
  const dLat = (lat2-lat1)*Math.PI/180;
  const dLon = (lon2-lon1)*Math.PI/180;
  const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)**2;
  const c = 2*Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  return (R*c).toFixed(2);
}

async function listNearby() {
  try {
    const loc = await getLocation();
    updateMap(loc.lat, loc.lon);
    const query = `[out:json];node(around:1000,${loc.lat},${loc.lon})[amenity];out;`;
    const res = await fetch(`https://overpass-api.de/api/interpreter?data=${encodeURIComponent(query)}`);
    const data = await res.json();
    if(data.elements && data.elements.length > 0){
      let html = `<table>
        <tr><th>Place Name</th><th>Type</th><th>Distance (km)</th><th>Walking Time (min)</th></tr>`;
      data.elements.slice(0,20).forEach((el,i)=>{
        const name = el.tags && (el.tags["name:en"] || el.tags.name) ? (el.tags["name:en"] || el.tags.name) : (el.tags ? el.tags.amenity : "Place");
        const type = el.tags && el.tags.amenity ? el.tags.amenity : "Unknown";
        const distance = getDistance(loc.lat, loc.lon, el.lat, el.lon);
        const time = Math.ceil(distance / 0.083);
        const osmLink = `https://www.openstreetmap.org/?mlat=${el.lat}&mlon=${el.lon}#map=18/${el.lat}/${el.lon}`;
        html += `<tr>
          <td style="word-break:break-word"><a class="place-link" href="${osmLink}" target="_blank" rel="noopener">${escapeHtml(name)}</a></td>
          <td>${escapeHtml(type)}</td>
          <td>${distance}</td>
          <td>${time}</td>
        </tr>`;
      });
      html += `</table>`;
      document.getElementById('output').innerHTML = html;
    } else { document.getElementById('output').innerText = "No nearby places found"; }
  } catch(err){ document.getElementById('output').innerText = "Failed to fetch nearby places"; }
}

function updateMap(lat, lon){
  const mapFrame = document.getElementById('osm-map');
  mapFrame.src = `https://www.openstreetmap.org/export/embed.html?bbox=${lon-0.01},${lat-0.01},${lon+0.01},${lat+0.01}&layer=mapnik&marker=${lat},${lon}`;
}

/* small helper to avoid HTML injection in place names */
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

/* Ensure canvases cover resized viewport */
window.addEventListener('resize', function(){
  resizeParticlesCanvas(); resizeRippleCanvas();
});

</script>
</body>
</html>
