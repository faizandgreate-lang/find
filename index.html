<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Smart Location Finder — Mobile Optimized</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --card-bg: rgba(255,255,255,0.86);
    --btn-bg: rgba(255,255,255,0.94);
    --text-color: #111;
    --muted: rgba(0,0,0,0.55);
    --accent: #0b74ff;
  }
  html,body{height:100%;margin:0;font-family:"Merriweather",serif;-webkit-font-smoothing:antialiased;}
  body{
    display:flex;flex-direction:column;align-items:center;min-height:100vh;
    color:var(--text-color);background:#fff;overflow-x:hidden;position:relative;
  }

  header{ width:92%; max-width:480px; margin:18px auto 6px; display:flex; align-items:center; justify-content:center; gap:12px; }
  .logo{ width:120px;border-radius:10px; box-shadow:0 8px 20px rgba(0,0,0,0.15); }
  .controls{ width:92%; max-width:480px; margin:12px auto; display:flex; flex-wrap:wrap; gap:10px; justify-content:center; }
  .btn{ padding:10px 16px;border-radius:12px;border:none;background:var(--btn-bg);font-weight:700;color:var(--text-color); min-width:140px; box-shadow:0 6px 20px rgba(0,0,0,0.12); cursor:pointer; }
  .btn.small{min-width:120px;padding:8px 14px}
  main{ width:92%; max-width:480px; margin:12px auto; display:flex; flex-direction:column; gap:10px; }
  #card{ width:100%; border-radius:14px; padding:12px; background:var(--card-bg); backdrop-filter: blur(8px) saturate(110%); box-shadow:0 12px 40px rgba(10,10,20,0.08); color:var(--text-color); }
  #mapFrameWrap{ width:100%; height:220px; border-radius:12px; overflow:hidden; box-shadow:inset 0 0 0 1px rgba(255,255,255,0.04); }
  iframe#osm-map{ width:100%; height:100%; border:0; display:block; }
  #output{ width:100%; margin-top:6px; color:var(--text-color); font-size:14px; }
  footer{ width:100%; text-align:center; padding:16px 8px 32px; color:var(--text-color); font-size:13px; }
  footer a{ color:var(--text-color); font-weight:700; text-decoration:none; margin:0 6px; display:inline-block; }
</style>
</head>
<body>

<header>
  <img class="logo" src="https://i.ibb.co/jPQz0mKf/Screenshot-2025-11-05-at-8-24-36-PM.png" alt="Logo">
</header>

<div class="controls">
  <button class="btn small" id="btnZip">Get My ZIP Code</button>
  <button class="btn small" id="btnAddress">Get My Address</button>
  <button class="btn small" id="btnNearby">List Nearby Places</button>
</div>

<main>
  <div id="card">
    <div id="mapFrameWrap">
      <iframe id="osm-map" loading="lazy" allowfullscreen src="https://www.openstreetmap.org/export/embed.html?bbox=46.665,24.705,46.685,24.725&layer=mapnik&marker=24.7136,46.6753"></iframe>
    </div>
    <div id="output">Results will appear here</div>
  </div>
</main>

<footer>
  <a href="https://www.instagram.com/mohammad_faizan_khan_/" target="_blank" rel="noopener">@mohammad_faizan_khan_</a> |
  <a href="https://mohammad.faizan.khan.linux-aios.com" target="_blank" rel="noopener">mohammad.faizan.khan.linux-aios.com</a>
  <div style="margin-top:8px; font-weight:600;">Thank you for visiting — I made this to help people find ZIP codes and nearby places.</div>
</footer>

<script>
const output = document.getElementById('output');
const osmMap = document.getElementById('osm-map');
const btnZip = document.getElementById('btnZip');
const btnAddress = document.getElementById('btnAddress');
const btnNearby = document.getElementById('btnNearby');

function getLocation(){ 
  return new Promise((resolve,reject)=>{
    if(navigator.geolocation){ navigator.geolocation.getCurrentPosition(pos=>resolve({lat:pos.coords.latitude, lon:pos.coords.longitude}), err=>reject(err)); }
    else reject(new Error('Geolocation not supported'));
  });
}

async function getZip(){
  try{
    output.innerText = 'Finding ZIP…';
    const loc = await getLocation();
    const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${loc.lat}&lon=${loc.lon}&format=json`);
    const data = await res.json();
    const zip = data.address && data.address.postcode ? data.address.postcode : 'Not found';
    output.innerHTML = `<strong>ZIP Code:</strong> ${zip}`;
    osmMap.src = `https://www.openstreetmap.org/export/embed.html?bbox=${loc.lon-0.01},${loc.lat-0.01},${loc.lon+0.01},${loc.lat+0.01}&layer=mapnik&marker=${loc.lat},${loc.lon}`;
  }catch(err){ output.innerText = 'Could not get ZIP — '+(err.message||err); }
}

async function getAddress(){
  try{
    output.innerText = 'Finding address…';
    const loc = await getLocation();
    const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${loc.lat}&lon=${loc.lon}&format=json`);
    const data = await res.json();
    const addr = data.display_name || 'Not found';
    output.innerHTML = `<strong>Address:</strong> ${addr}`;
    osmMap.src = `https://www.openstreetmap.org/export/embed.html?bbox=${loc.lon-0.01},${loc.lat-0.01},${loc.lon+0.01},${loc.lat+0.01}&layer=mapnik&marker=${loc.lat},${loc.lon}`;
  }catch(err){ output.innerText = 'Could not get address — '+(err.message||err); }
}

function getDistance(lat1, lon1, lat2, lon2){
  const R = 6371;
  const dLat = (lat2-lat1)*Math.PI/180;
  const dLon = (lon2-lon1)*Math.PI/180;
  const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)**2;
  const c = 2*Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  return R*c;
}

async function listNearby(){
  try{
    output.innerText = 'Looking for nearby places…';
    const loc = await getLocation();
    osmMap.src = `https://www.openstreetmap.org/export/embed.html?bbox=${loc.lon-0.01},${loc.lat-0.01},${loc.lon+0.01},${loc.lat+0.01}&layer=mapnik&marker=${loc.lat},${loc.lon}`;
    const query = `[out:json];(node(around:1000,${loc.lat},${loc.lon})[amenity];way(around:1000,${loc.lat},${loc.lon})[amenity];);out center 20;`;
    const res = await fetch(`https://overpass-api.de/api/interpreter?data=${encodeURIComponent(query)}`);
    const data = await res.json();
    if(!data.elements || data.elements.length===0){ output.innerText='No nearby places found.'; return; }
    let html = `<table style="width:100%; font-size:13px"><tr><th>Place</th><th>Type</th><th>Dist (m)</th><th>Walk (min)</th></tr>`;
    data.elements.slice(0,20).forEach(el=>{
      const lat = el.lat || (el.center && el.center.lat);
      const lon = el.lon || (el.center && el.center.lon);
      const name = (el.tags && (el.tags['name:en'] || el.tags.name)) || (el.tags ? el.tags.amenity : 'Place');
      const type = (el.tags && el.tags.amenity) || 'Unknown';
      const dist = Math.round(getDistance(loc.lat, loc.lon, lat, lon)*1000);
      const walk = Math.max(1, Math.ceil(dist/80));
      const link = `https://www.openstreetmap.org/?mlat=${lat}&mlon=${lon}#map=18/${lat}/${lon}`;
      html += `<tr><td><a href="${link}" target="_blank">${name}</a></td><td>${type}</td><td>${dist}</td><td>${walk}</td></tr>`;
    });
    html += `</table>`;
    output.innerHTML = html;
  }catch(err){ output.innerText = 'Failed to fetch nearby places — '+(err.message||err); }
}

btnZip.addEventListener('click', getZip);
btnAddress.addEventListener('click', getAddress);
btnNearby.addEventListener('click', listNearby);
</script>
</body>
</html>
